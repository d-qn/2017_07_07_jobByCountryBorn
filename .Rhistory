adat %>% mutate(lieuNaissance = factor(lieuNaissance, reorder(countryTot)))
ggplot(data = adat) + geom_col(aes(x = group, y = dev, fill = group)) +
facet_wrap(~ reorder(lieuNaissance, countryTot), nrow = 5) +
swi_theme() + scale_fill_manual(values = colors)
ggplot(data = adat) + geom_col(aes(x = group, y = dev, fill = group)) +
facet_wrap(~ reorder(lieuNaissance, -countryTot), nrow = 5) +
swi_theme() + scale_fill_manual(values = colors)
ggplot(data = adat) + geom_col(aes(x = group, y = dev, fill = group)) +
facet_wrap(~ reorder(lieuNaissance, -countryTot), nrow = 10) +
swi_theme() + scale_fill_manual(values = colors)
ggplot(data = adat) + geom_col(aes(x = group, y = dev, fill = group)) +
facet_wrap(~ reorder(lieuNaissance, -countryTot), nrow = 5) +
swi_theme() + scale_fill_manual(values = colors)
library("dplyr")
library("purrr")
df <- data_frame(
name = c("Animals", "Fruits", "Cars"),
y = c(5, 2, 4),
drilldown = tolower(name)
)
df
ds <- list_parse(df)
names(ds) <- NULL
str(ds)
hc <- highchart() %>%
hc_chart(type = "column") %>%
hc_title(text = "Basic drilldown") %>%
hc_xAxis(type = "category") %>%
hc_legend(enabled = FALSE) %>%
hc_plotOptions(
series = list(
boderWidth = 0,
dataLabels = list(enabled = TRUE)
)
) %>%
hc_add_series(
name = "Things",
colorByPoint = TRUE,
data = ds
)
dfan <- data_frame(
name = c("Cats", "Dogs", "Cows", "Sheep", "Pigs"),
value = c(4, 3, 1, 2, 1)
)
dffru <- data_frame(
name = c("Apple", "Organes"),
value = c(4, 2)
)
dfcar <- data_frame(
name = c("Toyota", "Opel", "Volkswage"),
value = c(4, 2, 2)
)
second_el_to_numeric <- function(ls){
map(ls, function(x){
x[[2]] <- as.numeric(x[[2]])
x
})
}
dsan <- second_el_to_numeric(list_parse2(dfan))
dsfru <- second_el_to_numeric(list_parse2(dffru))
dscar <- second_el_to_numeric(list_parse2(dfcar))
hc <- hc %>%
hc_drilldown(
allowPointDrilldown = TRUE,
series = list(
list(
id = "animals",
data = dsan
),
list(
id = "fruits",
data = dsfru
),
list(
id = "cars",
data = dscar
)
)
)
hc
library(highcharter)
library("dplyr")
library("purrr")
df <- data_frame(
name = c("Animals", "Fruits", "Cars"),
y = c(5, 2, 4),
drilldown = tolower(name)
)
df
ds <- list_parse(df)
names(ds) <- NULL
str(ds)
hc <- highchart() %>%
hc_chart(type = "column") %>%
hc_title(text = "Basic drilldown") %>%
hc_xAxis(type = "category") %>%
hc_legend(enabled = FALSE) %>%
hc_plotOptions(
series = list(
boderWidth = 0,
dataLabels = list(enabled = TRUE)
)
) %>%
hc_add_series(
name = "Things",
colorByPoint = TRUE,
data = ds
)
dfan <- data_frame(
name = c("Cats", "Dogs", "Cows", "Sheep", "Pigs"),
value = c(4, 3, 1, 2, 1)
)
dffru <- data_frame(
name = c("Apple", "Organes"),
value = c(4, 2)
)
dfcar <- data_frame(
name = c("Toyota", "Opel", "Volkswage"),
value = c(4, 2, 2)
)
second_el_to_numeric <- function(ls){
map(ls, function(x){
x[[2]] <- as.numeric(x[[2]])
x
})
}
dsan <- second_el_to_numeric(list_parse2(dfan))
dsfru <- second_el_to_numeric(list_parse2(dffru))
dscar <- second_el_to_numeric(list_parse2(dfcar))
hc <- hc %>%
hc_drilldown(
allowPointDrilldown = TRUE,
series = list(
list(
id = "animals",
data = dsan
),
list(
id = "fruits",
data = dsfru
),
list(
id = "cars",
data = dscar
)
)
)
hc
adat
str(data)
data
adat
ggplot(data = adat) + geom_col(aes(x = group, y = dev, fill = group)) +
facet_wrap(~ reorder(lieuNaissance, -countryTot), nrow = 5) +
swi_theme() + scale_fill_manual(values = colors)
dataa <- left_join(
data %>% filter(isco >= 1000) %>% mutate(group = factor(isco %/% 1000)),
adat %>% select(group, lieuNaissance, dev)
)
head(dataa)
dataa
byIscoTot <- dataa %>% group_by(isco) %>%
summarise(iscoTot = sum(valeur, na.rm = T)) %>%
ungroup() %>%
mutate(shareTot = (iscoTot / sum(groupTot)) * 100)
byIscoTot <- dataa %>% group_by(isco) %>%
summarise(iscoTot = sum(valeur, na.rm = T)) %>%
ungroup() %>%
mutate(shareTot = (iscoTot / sum(iscoTot)) * 100)
byIscoTot
dataa
dataa
byCountryTot
str(adat)
dataa <- left_join(
data %>% filter(isco >= 1000) %>% mutate(group = factor(isco %/% 1000)),
adat %>% select(group, lieuNaissance, countryTot, dev)
)
byIscoTot <- dataa %>% group_by(isco) %>%
summarise(iscoTot = sum(valeur, na.rm = T)) %>%
ungroup() %>%
mutate(shareTot = (iscoTot / sum(iscoTot)) * 100)
dataa
dataa <- left_join(
data %>% filter(isco >= 1000) %>% mutate(group = factor(isco %/% 1000)),
adat %>% select(group, lieuNaissance, countryTot, dev)
) %>% mutate(devIsco = valeur / countryTot)
dataa
dataa <- left_join(
data %>% filter(isco >= 1000) %>% mutate(group = factor(isco %/% 1000)),
adat %>% select(group, lieuNaissance, countryTot, dev)
) %>% mutate(devIsco = valeur / countryTot)
byIscoTot <- dataa %>% group_by(isco) %>%
summarise(iscoTot = sum(valeur, na.rm = T)) %>%
ungroup() %>%
mutate(shareTot = (iscoTot / sum(iscoTot)) * 100)
dataa <- left_join(dataa, byIscoTot )
head(dataa)
dataa <- left_join(
data %>% filter(isco >= 1000) %>% mutate(group = factor(isco %/% 1000)),
adat %>% select(group, lieuNaissance, countryTot, dev)
) %>% mutate(devIsco = valeur / countryTot)
byIscoTot <- dataa %>% group_by(isco) %>%
summarise(iscoTot = sum(valeur, na.rm = T)) %>%
ungroup() %>%
mutate(shareTot = (iscoTot / sum(iscoTot)) * 100)
dataa <- left_join(dataa, byIscoTot)
dataa
dataa <- left_join(
data %>% filter(isco >= 1000) %>% mutate(group = factor(isco %/% 1000)),
adat %>% select(group, lieuNaissance, countryTot, dev)
) %>% mutate(shareIsco = valeur / countryTot)
byIscoTot <- dataa %>% group_by(isco) %>%
summarise(iscoTot = sum(valeur, na.rm = T)) %>%
ungroup() %>%
mutate(shareTot = (iscoTot / sum(iscoTot)) * 100)
dataa <- left_join(dataa, byIscoTot) %>%
mutate(devIsco = shareIsco - shareTot)
dataa
hist(dataa$devIsco)
byIscoTot
hist(dataa$devIsco, breaks = 20)
joy plot
byIscoTot
tail(dataa)
dataa %>% group_by(lieuNaissance) %>% summarise(test = sum(shareTot))
dataa %>% group_by(lieuNaissance) %>% summarise(test = sum(shareTot), test2 = sum(shareIsco))
dataa %>% group_by(lieuNaissance) %>% summarise(test = sum(shareTot), test2 = sum(shareIsco, na.rm = T))
dataa <- left_join(
data %>% filter(isco >= 1000) %>% mutate(group = factor(isco %/% 1000)),
adat %>% select(group, lieuNaissance, countryTot, dev)
) %>% mutate(shareIsco = (valeur / countryTot) * 100)
byIscoTot <- dataa %>% group_by(isco) %>%
summarise(iscoTot = sum(valeur, na.rm = T)) %>%
ungroup() %>%
mutate(shareTot = (iscoTot / sum(iscoTot)) * 100)
dataa <- left_join(dataa, byIscoTot) %>%
mutate(devIsco = shareIsco - shareTot)
# check
dataa %>% group_by(lieuNaissance) %>% summarise(test = sum(shareTot), test2 = sum(shareIsco, na.rm = T))
hist(dataa$devIsco, breaks = 20)
hist(dataa$devIsco, breaks = 200)
dataa %>% filter(devIsco >= 1)
dataa %>% filter(devIsco >= 5)
dataa %>% filter(devIsco >= 1)
dataa %>% filter(devIsco >= 1) %>% View()
dataa %>% filter(devIsco >= 2) %>% View()
dataa %>% filter(devIsco >= 2)
dataa
tail(dataa)
dataa %>% gggplot() + geom_histogram(aes(devIsco))
dataa %>% ggplot() + geom_histogram(aes(devIsco))
dataa %>% ggplot() + geom_histogram(aes(devIsco), binwidth = 0.1)
dataa %>% ggplot() + geom_histogram(aes(devIsco), binwidth = 0.1) + swi_theme()
dataa %>% filter(devIsco >= 2)
ggplot(data = adat) + geom_col(aes(x = group, y = dev, fill = group)) +
facet_wrap(~ reorder(lieuNaissance, -countryTot), nrow = 5) +
swi_theme() + scale_fill_manual(values = colors)
dataa %>% filter(abs(dev) >= 5)
?strwidth
strwidth("AB", units = "figure")
strwidth("A", units = "figure")
strwidth("a", units = "figure")
ls()
dataa %>% filter(abs(dev) >= 5) %>%
group_by(group, lieuNaissance)
dataa
ggplot(data = adat) + geom_col(aes(x = group, y = dev, fill = group)) +
facet_wrap(~ reorder(lieuNaissance, -countryTot), nrow = 5) +
swi_theme() + scale_fill_manual(values = colors)
ggplot(data = adat) + geom_col(aes(x = group, y = dev, fill = group)) +
facet_wrap(~ reorder(lieuNaissance, -countryTot), nrow = 5) +
swi_theme() + scale_fill_manual(values = colors)
dataa %>% filter(abs(dev) >= 5) %>%
group_by(group, lieuNaissance)
dataa %>% filter(abs(dev) >= 5) %>%
group_by(group, lieuNaissance)
dataa %>% filter(abs(dev) >= 5) %>%
group_by(group, lieuNaissance) %>% select(description, devIsco)
dataa %>% filter(abs(dev) >= 5) %>%
group_by(group, lieuNaissance)
dataa %>% filter(abs(dev) >= 5) %>%
group_by(group, lieuNaissance) %>% select(description, devIsco)
dataa %>% filter(abs(dev) >= 5)
?nse
vignette("nse")
dataa %>% filter(abs(dev) >= 5) %>%
group_by(group, lieuNaissance)
dataa %>% filter(abs(dev) >= 5) %>%
group_by(group, lieuNaissance)
dataa %>% filter(abs(dev) >= 5) %>%
group_by(group, lieuNaissance) %>% filter(devIsco > 1)
dataa %>% filter(abs(dev) >= 5) %>%
group_by(group, lieuNaissance) %>% filter(devIsco > 2) %>%
dataa %>% filter(abs(dev) >= 5) %>%
group_by(group, lieuNaissance) %>% filter(devIsco > 2) %>% select(description, valeur, devIsco)
dataa %>% filter(abs(dev) >= 5) %>%
group_by(group, lieuNaissance) %>%
filter(devIsco > 2) %>%
select(description, valeur, devIsco) %>%
ungroup()
dataa %>% filter(abs(dev) >= 5) %>%
group_by(group, lieuNaissance) %>%
filter(devIsco > 2) %>%
select(description, valeur, devIsco) %>%
ungroup() %>% View()
dataa %>% filter(abs(dev) >= 5) %>%
group_by(group, lieuNaissance) %>%
filter(devIsco > 2) %>%
select(description, valeur, devIsco) %>%
ungroup() %>% View()
excel.file <- "data/4 Participation in the Sectors of the Labor Market_SwissInfo.xlsx"
library(tidyverse)
library(scales)
library(magrittr)
library(countrycode)
library(swiMap)
library(swiTheme)
### Getting data in packages
library(readxl)
### Interactive
library(htmltools)
library(shiny)
library(swiRcharts)
library(rCharts)
### Mapping
# require(rgdal)
# require(rgeos)
# require(maptools)
### Misc stuff
#require(classInt)
#require(viridis)
dataa %>% filter(abs(dev) >= 4) %>%
group_by(group, lieuNaissance) %>%
filter(devIsco > 1) %>%
select(description, valeur, devIsco) %>%
ungroup() %>% View()
### Getting data in packages
ggplot(data = adat) + geom_col(aes(x = group, y = dev, fill = group)) +
facet_wrap(~ reorder(lieuNaissance, -countryTot), nrow = 5) +
swi_theme() + scale_fill_manual(values = colors)
?grid.text
install.packages("radarchart")
install.packages("radarchart")
library(radarchart)
labs <- c("Communicator", "Data Wangler", "Programmer",
"Technologist",  "Modeller", "Visualizer")
scores <- list(
"Rich" = c(9, 7, 4, 5, 3, 7),
"Andy" = c(7, 6, 6, 2, 6, 9),
"Aimee" = c(6, 5, 8, 4, 7, 6)
)
chartJSRadar(scores = scores, labs = labs, maxScale = 10)
dataa %>% filter(abs(dev) >= 4) %>%
group_by(group, lieuNaissance) %>%
filter(devIsco > 1) %>%
select(description, valeur, devIsco) %>%
ungroup() %>% View()
data
str(data)
head(data)
data %>%
filter(isco >= 1000) %>%
mutate(origin = ifelse(lieuNaissance == "Suisse", "Suisse", "Etranger")) %>%
group_by(isco, origin) %>%
summarise(valeur = sum(valeur, na.rm = T)) %>%
ungroup()
data %>%
filter(isco >= 1000) %>%
mutate(origin = ifelse(lieuNaissance == "Suisse", "Suisse", "Etranger")) %>%
group_by(isco, description, origin) %>%
summarise(valeur = sum(valeur, na.rm = T)) %>%
ungroup()
data %>%
filter(isco >= 1000) %>%
mutate(origin = ifelse(lieuNaissance == "Suisse", "Suisse", "Etranger")) %>%
group_by(isco, description, origin) %>%
summarise(valeur = sum(valeur, na.rm = T)) %>%
ungroup() %>%
group_by(isco, description) %>%
mutate(totIsco = sum(valeur, na.rm = T))
data %>%
filter(isco >= 1000) %>%
mutate(origin = ifelse(lieuNaissance == "Suisse", "Suisse", "Etranger")) %>%
group_by(isco, description, origin) %>%
summarise(valeur = sum(valeur, na.rm = T)) %>%
ungroup() %>%
group_by(isco, description) %>%
mutate(totIsco = sum(valeur, na.rm = T)) %>%
ungroup() %>%
mutate(share = (valeur / totIsco) * 100)
data %>%
filter(isco >= 1000) %>%
mutate(origin = ifelse(lieuNaissance == "Suisse", "Suisse", "Etranger")) %>%
group_by(isco, description, origin) %>%
summarise(valeur = sum(valeur, na.rm = T)) %>%
ungroup() %>%
group_by(isco, description) %>%
mutate(totIsco = sum(valeur, na.rm = T)) %>%
ungroup() %>%
mutate(share = (valeur / totIsco) * 100) %>%
arrange(share, origin)
data %>%
filter(isco >= 1000) %>%
mutate(origin = ifelse(lieuNaissance == "Suisse", "Suisse", "Etranger")) %>%
group_by(isco, description, origin) %>%
summarise(valeur = sum(valeur, na.rm = T)) %>%
ungroup() %>%
group_by(isco, description) %>%
mutate(totIsco = sum(valeur, na.rm = T)) %>%
ungroup() %>%
mutate(share = (valeur / totIsco) * 100) %>%
arrange(share, origin)datab <- data %>%
filter(isco >= 1000) %>%
mutate(origin = ifelse(lieuNaissance == "Suisse", "Suisse", "Etranger")) %>%
group_by(isco, description, origin) %>%
summarise(valeur = sum(valeur, na.rm = T)) %>%
ungroup() %>%
group_by(isco, description) %>%
mutate(totIsco = sum(valeur, na.rm = T)) %>%
ungroup() %>%
mutate(share = (valeur / totIsco) * 100) %>%
arrange(share, origin)
datab <- data %>%
filter(isco >= 1000) %>%
mutate(origin = ifelse(lieuNaissance == "Suisse", "Suisse", "Etranger")) %>%
group_by(isco, description, origin) %>%
summarise(valeur = sum(valeur, na.rm = T)) %>%
ungroup() %>%
group_by(isco, description) %>%
mutate(totIsco = sum(valeur, na.rm = T)) %>%
ungroup() %>%
mutate(share = (valeur / totIsco) * 100) %>%
arrange(share, origin)
datab %>% View()
datab
datab %>% filter(valeur > 0)
datab %>% filter(valeur > 0) %>% View()
datab %>% filter(valeur > 0, totIsco > 1000) %>% View()
datab %>% filter(valeur > 0, totIsco > 10000) %>% View()
datab <- data %>%
filter(isco >= 1000) %>%
mutate(origin = ifelse(lieuNaissance == "Suisse", "Suisse", "Etranger")) %>%
group_by(isco, description, origin) %>%
summarise(valeur = sum(valeur, na.rm = T)) %>%
ungroup() %>%
group_by(isco, description) %>%
mutate(totIsco = sum(valeur, na.rm = T)) %>%
ungroup() %>%
mutate(share = (valeur / totIsco) * 100) %>%
mutate(group = isco %/% 1000)
datab
datab <- data %>%
filter(isco >= 1000) %>%
mutate(origin = ifelse(lieuNaissance == "Suisse", "Suisse", "Etranger")) %>%
group_by(isco, description, origin) %>%
summarise(valeur = sum(valeur, na.rm = T)) %>%
ungroup() %>%
group_by(isco, description) %>%
mutate(totIsco = sum(valeur, na.rm = T)) %>%
ungroup() %>%
mutate(share = (valeur / totIsco) * 100) %>%
mutate(group = isco %/% 1000) %>%
group_by(group, origin) %>%
summarise(totGroupOri = sum(valeur, na.rm = T)) %>%
ungroup()
datab
datab <- data %>%
filter(isco >= 1000) %>%
mutate(origin = ifelse(lieuNaissance == "Suisse", "Suisse", "Etranger")) %>%
group_by(isco, description, origin) %>%
summarise(valeur = sum(valeur, na.rm = T)) %>%
ungroup() %>%
group_by(isco, description) %>%
mutate(totIsco = sum(valeur, na.rm = T)) %>%
ungroup() %>%
mutate(share = (valeur / totIsco) * 100) %>%
mutate(group = isco %/% 1000) %>%
group_by(group, origin) %>%
mutate(totGroupOri = sum(valeur, na.rm = T)) %>%
ungroup()
datab
datac %>%
filter(isco >= 1000) %>%
mutate(origin = ifelse(lieuNaissance == "Suisse", "Suisse", "Etranger")) %>%
mutate(group = isco %/% 1000) %>%
group_by(group, origin) %>%
mutate(totGroupOri = sum(valeur, na.rm = T)) %>%
ungroup()
datac <- data %>%
filter(isco >= 1000) %>%
mutate(origin = ifelse(lieuNaissance == "Suisse", "Suisse", "Etranger")) %>%
mutate(group = isco %/% 1000) %>%
group_by(group, origin) %>%
mutate(totGroupOri = sum(valeur, na.rm = T)) %>%
ungroup()
datac
datac <- data %>%
filter(isco >= 1000) %>%
mutate(origin = ifelse(lieuNaissance == "Suisse", "Suisse", "Etranger")) %>%
mutate(group = isco %/% 1000) %>%
group_by(group, origin) %>%
summarise(totGroupOri = sum(valeur, na.rm = T)) %>%
ungroup()
datac
Sys.setenv(http_proxy="http://nguyendu:t0ast3r!@proxy.media.int:8080")
Sys.setenv(https_proxy="https://nguyendu:t0ast3r!@proxy.media.int:8080")
3478
2000 / 3.5
2000 / 3.3
2000 / 3.2
3478 / 3.2
